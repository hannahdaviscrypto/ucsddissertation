
\def\Bellare{Mihir Bellare}
\def\BellareEmail{{\tt mihir@eng.ucsd.edu}}
\def\BellareWebpage{{\tt cseweb.\allowbreak ucsd.\allowbreak
		edu/\allowbreak \textasciitilde mihir}}
\def\BellareDept{Dept. of Computer Science \& Engineering}
\def\BellareCompany{University of California San Diego}
\def\BellareAddress{9500 Gilman Drive, La Jolla, California 92093,
	USA}

\def\BellareThanks{
	\BellareDept,
	\BellareCompany,
	\BellareAddress.
	Email: {\BellareEmail}.
	URL: {\BellareWebpage}. Supported in part by NSF grant CNS-1717640 and a gift from Microsoft.}


\def\BellareInstitute{
	\BellareDept,
	\BellareCompany.
	%\BellareEmail.
	%\BellareWebpage.
}


\def\Davis{Hannah Davis}
\def\DavisEmail{{\tt h3davis@eng.ucsd.edu}}
\def\DavisWebpage{https://cseweb.\allowbreak ucsd.\allowbreak edu/\allowbreak\textasciitilde h3davis}
\def\DavisDept{Department of Computer Science \& Engineering}
\def\DavisCompany{University of California San Diego}
\def\DavisAddress{9500 Gilman Drive, La Jolla, California 92093,
	USA}

\def\DavisThanks{
	\DavisDept,
	\DavisCompany,
	\DavisAddress.
	Email: {\DavisEmail}.
	Supported in part by NSF grant CNS-1717640.}

\def\DavisInstitute{
	\DavisDept,
	\DavisCompany.
	%\email{\DavisEmail}.
	%\email{\DavisWebpage}.
}



%
% Mihir and Hannah jointly
%
\def\BellareDavisInstitute{
	\BellareDept,
	\BellareCompany.\\
	{\tt \{mihir,h3davis\}@eng.ucsd.edu}
	\quad
	{\tt https://cseweb.\allowbreak{}ucsd.\allowbreak{}edu/\allowbreak\textasciitilde{}\{mihir,h3davis\}}
}


%
% Felix GÃ¼nther
%

\def\Guenther{Felix G{\"u}nther}
\def\GuentherEmail{{\tt mail@felixguenther.info}}
\def\GuentherWebpage{{\tt https://www.\allowbreak{}felixguenther.\allowbreak{}info}}
\def\GuentherDept{Department of Computer Science}
\def\GuentherCompany{ETH Z{\"u}rich}
\def\GuentherAddress{Universit{\"a}tstrasse 6, 8092 Z{\"u}rich, Switzerland}

\def\GuentherThanks{
	\GuentherDept,
	\GuentherCompany,
	\GuentherAddress.
	Email: {\tt \GuentherEmail}.
	URL: {\tt \GuentherWebpage}. Supported in part by Research Fellowship grant GU 1859/1-1 of the German Research Foundation (DFG) and NSF grant CNS-1717640.}

\def\GuentherInstitute{
	\GuentherDept,
	\GuentherCompany.\\
	{\GuentherEmail}
	\quad
	{\GuentherWebpage}
}




\newcommand{\titletext}{Separate Your Domains:\texorpdfstring{\\}{}NIST PQC KEMs, Oracle Cloning and Read-Only Indifferentiability}


\newcommand{\shorttitletext}{NIST PQC KEMs, Oracle Cloning and Read-Only Indifferentiability}

\newcommand{\abstracttext}{It is convenient and common for schemes in the random oracle model to assume access to multiple random oracles (ROs), leaving to implementations the task ---we call it oracle cloning--- of constructing them from a single RO. The first part of the paper is a case study of oracle cloning in KEM submissions to the NIST Post-Quantum Cryptography standardization process. We give key-recovery attacks on some submissions arising from mistakes in oracle cloning, and find other submissions using oracle cloning methods whose validity is unclear. Motivated by this, the second part of the paper gives a theoretical treatment of oracle cloning. We give a definition of what is an ``oracle cloning method'' and what it means for such a method to ``work,'' in a framework we call read-only indifferentiability, a simple variant of classical indifferentiability that yields security not only for usage in single-stage games but also in multi-stage ones. We formalize domain separation, and specify and study many oracle cloning methods, including common domain-separating ones, giving some general results to justify (prove read-only indifferentiability of) certain classes of methods. We are not only able to validate the oracle cloning methods used in many of the unbroken NIST PQC KEMs, but also able to specify and validate oracle cloning methods that may be useful beyond that.}


\ifnum\llncs=1
\newcommand{\pubinfo}{}
\else
\newcommand{\pubinfo}{On-going work, not for distribution.}
\fi


\title{{\bf \titletext}\ifnum\fullversion=1\vspace{0.2in}\fi}
\ifnum\llncs=1
% llncs format
\titlerunning{\shorttitletext}
%\ifnum\anonymous=1
%\author{}
%\authorrunning{Anonymous submission to Eurocrypt 2020}
%\institute{}
%\else
\author{
	\Bellare\inst{1} \and \Davis\inst{1} \and \Guenther\inst{2}
}
\institute{% Department of Computer Science and Engineering, University of California San Diego.
% 	\BellareInstitute \and 
% 	\DavisInstitute \and 
	\BellareDavisInstitute \and
	\GuentherInstitute
}
\authorrunning{Bellare, Davis, G\"{u}nther}
\else
\author{
	\Bellare\thanks{\ \BellareThanks} \and \Davis\thanks{\ \DavisThanks} \and \Guenther\thanks{\ \GuentherThanks} \vspace{0.2in}
}
\appearsin{A preliminary version of this paper appears in Eurocrypt 2020. This is the full version.}
\date{February 2020} 



\fi


\maketitle

\begin{abstract}
	\abstracttext
	\ifnum\submission=1
	%
	\vspace{1em}
	\noindent \keywordstext
	\fi
\end{abstract}
\ifnum\fullversion=1\newpage\fi 
% These are not needed for final version, right?
%\keywords{Random oracle model \and Domain separation \and Key encapsulation mechanism \and NIST post-quantum cryptography}

%\fi % llncs=1

%\else
%\ifnum\anonymous=1
%\date{}
%\appearsin{}
%\title{\textbf{\titletext}\vspace{-0.3in}}
%\author{}
%\maketitle
%\vspace{-0.4in}
%\begin{abstract}
%	\abstracttext
%	\vspace{0.15in}
%	
%	\noindent \keywordstext
%\end{abstract}\vspace{0.2in}
%\vspace{-0.2in}
%\else
%\appearsin{\pubinfo}
%\title{{\bf \titletext}\vspace{0.2in}}
%\author{
%	\ifnum\instplace=0
%	{\sc \Bellare}\thanks{~\BellareThanks} \and
%	{\sc \Davis}\thanks{~\DavisThanks} \and
%	{\sc \Guenther}\thanks{~\GuentherThanks}
%	\else
%	{\Bellare$^{1}$} \and
%	{\Davis$^{2}$} \and
%	{\Guenther$^{2}$}
%	\fi
%}
%\date{\protect\vspace{0.2in} \today}
%\maketitle
%
%\ifnum\instplace=1
%\vspace{-0.2in}
%\begin{center}
%	\begin{small}
%		$^{1}$~\BellareThanksInline \\
%		$^{2}$~\DavisThanksInline \\
%		$^{3}$~\GuentherThanksInline \\
%	\end{small}
%\end{center}
%\vspace{0.2in}
%\fi
%\begin{abstract}
%	\abstracttext
%	
%	%    \vspace{0.1in}
%	%    \noindent
%	%    \keywordstext
%\end{abstract}
%\thispagestyle{empty}\newpage\setcounter{page}{1}
%\ifnum\addtoc=1
%\pagenumbering{roman}
%\newpage
%\def\baselinestretch{0.9}
%\tableofcontents
%\def\baselinestretch{1.0}
%\newpage
%\pagenumbering{arabic}
%\setcounter{page}{1}
%\fi
%\fi
%\fi

