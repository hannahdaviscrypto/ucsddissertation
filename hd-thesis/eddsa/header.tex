\newcommand{\hd}[1]{{\color{teal}hd: #1}}
\newcommand{\zd}[1]{{\color{teal}zd: #1}}
\newcommand{\TODO}[1]{{\color{red}TODO: #1}}

\newcommand{\V}{\mathsf{V}}
\newcommand{\Vf}{\mathsf{Vf}}
\newcommand{\oseed}[0]{{fs}}
\newcommand{\kseed}[0]{{ks}}

\newcommand{\numUsers}[0]{u}
\newcommand{\Outputs}{\mathrm{OUT}}

\newcommand{\T}{T}
\newcommand{\Thh}{\text{T}_{\hh}}
\newcommand{\THH}{\text{T}_{\HH}}
\newcommand{\public}{\texttt{pub}}
\newcommand{\all}{\texttt{all}}
\newcommand{\fdistrib}{\overline{\distrib}}
\newcommand{\INTDIV}{INTDIV}


\DeclareMathAlphabet{\mathsl}{OT1}{cmr}{m}{sl}
\DeclareMathAlphabet{\mathsc}{OT1}{cmr}{m}{sc}

% ====================================================================

\renewcommand{\topfraction}{0.99} % max fraction of floats at top
\renewcommand{\bottomfraction}{0.8}	% max fraction of floats at bottom
%   Parameters for TEXT pages (not float pages):
\setcounter{topnumber}{2}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{2}     % 2 may work better
\setcounter{dbltopnumber}{2}    % for 2-column pages
\renewcommand{\dbltopfraction}{0.9}	% fit big float above 2-col. text
\renewcommand{\textfraction}{0.07}	% allow minimal text w. figs
%   Parameters for FLOAT pages (not text pages):
\renewcommand{\floatpagefraction}{0.7}	% require fuller float pages
	% N.B.: floatpagefraction MUST be less than topfraction !!
\renewcommand{\dblfloatpagefraction}{0.7}	% require fuller float pages

\hyphenation{whe-ther}
\hyphenation{indepen-dently}
\hyphenation{Schw-abe}

% Theorem environments
\theoremstyle{plain}
\newtheorem{propo}{Proposition}
\newenvironment{proposition}{\begin{propo}\begin{rm}}%
		{\end{rm}\end{propo}}

\def\sqed{{\hspace{1pt}\rule[-1pt]{3pt}{9pt}}}
\def\qedsym{\hspace{1pt}\rule[-1pt]{3pt}{9pt}}
\newcommand{\mybox}{\raisebox{-1.5pt}{{\Large $\Box$}}}
\def\enddef{{\sqed}}

		% Lists
% =========================================================================

% General
\newcommand{\headingu}[1]{\vspace{3pt}\noindent\underline{\textsc{#1}}}
\newcommand{\noskipheading}[1]{\noskipheadingu{#1}}
\newcommand{\noskipheadingu}[1]{\noindent\underline{\textsc{#1}}}

\def\bits{\{0,1\}}
\def\cross{\times}

% ========================================================================


\newcommand{\mihirnote}[1]{\authnote{Mihir}{#1}{red}}
\newcommand{\hannahnote}[1]{\authnote{Hannah}{#1}{red}}

% ==================================================================
% Definitions for this paper
% ==================================================================

% Other defs

\newcommand{\subgroup}{\mathds{S}}

\newcommand{\generatorEDSA}{\mathtt{B}}


\newcommand{\compF}[0]{\mathsf{h}}

\newcommand{\Scheme}[1]{\mathsf{#1}}
\newcommand{\KeyGen}[1]{\Scheme{#1}.\mathsf{KeyGen}}
\newcommand{\SignAlg}[1]{\Scheme{#1}.\mathsf{Sign}}
\newcommand{\Vfy}[1]{\Scheme{#1}.\mathsf{Verify}}
\newcommand{\Enc}[1]{\Scheme{#1}.\mathsf{Encode}}
\newcommand{\Dec}[1]{\Scheme{#1}.\mathsf{Decode}}
\newcommand{\curvepoint}[1]{\mathtt{#1}}
\newcommand{\msg}{{M}}
\newcommand{\sig}{\sigma}
\newcommand{\hashEDSA}{\mathtt{H}}
\newcommand{\sha}[1]{\mathtt{sha{#1}}}
\newcommand{\SHAtwo}{\texttt{SHA256}}
\newcommand{\SHAfive}{\texttt{SHA512}}
\newcommand{\SHAthree}{\texttt{SHA3}}
\newcommand{\MD}{\construct{MD}}
\newcommand{\ChopMD}{\construct{Chop\mbox{-}MD}}
\newcommand{\ModMD}{\construct{Mod\mbox{-}MD}}
\newcommand{\ShrinkMD}{\construct{Shrink\mbox{-}MD}}
\newcommand{\ACSC}{\construct{ACSC}}
\newcommand{\CSC}{\construct{CSC}}
\newcommand{\chopMD}{\mathtt{chop\mbox{-}MD}}
\newcommand{\padF}[0]{\mathsf{pad}}
\newcommand{\UnPadF}[0]{\mathsf{unpad}}
\newcommand{\initV}[0]{y[0]}
\newcommand{\QL}{QL}

\newcommand{\CFEDSA}{\mathtt{CF}}
\newcommand{\CL}{\mathtt{CL}}
\newcommand{\EdID}[0]{\mathsf{EdID}}

\newcommand{\advAUF}[0]{A_{\mathrm{UF}}}
\newcommand{\advADL}[0]{A_{\mathrm{DL}}}
\newcommand{\DLP}[0]{\mathrm{DL}}
\newcommand{\MBDLP}[0]{\mathrm{MBDL}}
\newcommand{\epsDL}[0]{\epsilon_{\mathrm{DL}}}
\newcommand{\epsUF}[0]{\epsilon_{\mathrm{UF}}}
\newcommand{\epsMUF}[0]{\epsilon_{\mathrm{MUF}}}
\newcommand{\probP}[0]{\mathrm{P}}
\newcommand{\epsP}[0]{\epsilon_{\mathrm{P}}}
\newcommand{\reducesTo}[0]{\!\rightarrow\!}
\newcommand{\eqSmall}[0]{\!=\!}


\newcommand{\mpage}[2]{\begin{minipage}{#1\textwidth}
    #2 \end{minipage}}


\newcommand{\genGame}[3]{\Game^{\mathsf{#1}}_{#2}(#3)}

\newcommand{\GameName}[1]{\mathrm{#1}}
\newcommand{\DS}{\mathsf{DS}}
\newcommand{\fDS}{\overline{\mathsf{DS}}}
\newcommand{\jDS}{\mathsf{DS}^*}

\newcommand{\STable}[0]{\mathrm{ST}}

\newcommand{\vk}{\mathsl{vk}}
\newcommand{\osk}{\overline{\sk}}
\newcommand{\opk}{\overline{\pk}}
\newcommand{\oek}{\overline{\ek}}
\newcommand{\ovk}{\overline{\vk}}
\newcommand{\vecPk}{\boldsymbol{vk}}
\newcommand{\vecSk}{\boldsymbol{sk}}
\newcommand{\pkSpace}{\mathbf{VK}}

%%%%%%%%%%new macros
\newcommand{\h}{\mathsl{h}} 
\newcommand{\s}{\mathsl{s}}
\newcommand{\littler}{\mathsl{r}}
\newcommand{\n}{\mathsl{n}}
\newcommand{\CapitalS}{\mathsl{S}}
\newcommand{\z}{\mathsl{z}}
\newcommand{\eEDSA}{\mathsl{e}}
\newcommand{\dd}{\mathsl{d}}
\newcommand{\XEDSA}{\mathsl{X}}
\newcommand{\YEDSA}{\mathsl{Y}}
%%%%%%%%%%%%%%%%%

\newcommand{\FuncEDSA}[0]{\mathrm{FNS}}
\newcommand{\Time}[1]{\mathrm{T}_{#1}}
\newcommand{\Queries}[2]{\mathrm{Q}_{#1}^{#2}}
\newcommand{\QueriesD}[2]{\mathrm{q}_{#1}^{#2}}

\newcommand{\gameSymbol}[0]{\mathbf{G}}
\newcommand{\MBDL}{\gameSymbol^{\mathrm{mbdl}}}
\newcommand{\OMDL}{\gameSymbol^{\mathrm{omdl}}}


\newcommand{\GMBDL}{\gameSymbol^{\mathrm{gg}\mbox{-}\mathrm{mbdl}}}

\newcommand{\gDL}{\gameSymbol^{\mathrm{dl}}}
\newcommand{\DL}{\mathsf{DL}}
\newcommand{\DLO}{\mathsc{DLO}}
\newcommand{\mbdlAdv}[2]{\genAdv{mbdl}{#1}{#2}}
\newcommand{\dlAdv}[2]{\genAdv{dl}{#1}{#2}}


\newcommand{\SchID}{\mathsf{SchID}}
\newcommand{\SchSig}{\mathsf{Sch}}
\newcommand{\SchSigCl}[1]{\JCTransform[\SchSig,#1]}
\newcommand{\ourF}[0]{\construct{S}}

%\newcommand{\idFunctor}[0]{\construct{R}}
\newcommand{\idFunctortwo}[0]{\construct{P}}

\newcommand{\paAdv}[2]{\genAdv{imp\mbox{-}pa}{#1}{#2}}
\newcommand{\ufAdv}[2]{\genAdv{uf}{#1}{#2}}
\newcommand{\fufAdv}[2]{\genAdv{\mathrm{f}\mbox{-}\mathrm{uf}}{#1}{#2}}
\newcommand{\findiffAdv}[2]{\genAdv{\findiff}{#1}{#2}}

%\newcommand{\prfAdv}[2]{\genAdv{prf}{#1}{#2}}
\newcommand{\prgAdv}[2]{\genAdv{prg}{#1}{#2}}
\newcommand{\distAdv}[2]{\genAdv{dist}{#1}{#2}}

\newcommand{\sign}{\mathsf{sign}}

%\newcommand{\Initialize}{\mathsc{Init}} 
%\newcommand{\Finalize}{\mathsc{Fin}}
\newcommand{\NewO}[0]{\mathsc{New}}
%\newcommand{\FnO}[0]{\mathsc{Fn}}
\newcommand{\SignO}[0]{\mathsc{Sign}}

\newcommand{\SignOSim}[0]{\mathsc{SignSim}}


\newcommand{\Exec}{\mathsf{Exec}}

\newcommand{\Sign}{\mathsf{Sign}} 

\newcommand{\SignOO}{\SignO}

\newcommand{\UFCMA}{\mathbf{G}^{\mathrm{uf}}}
\newcommand{\mUFCMA}{\mathbf{G}^{\mathrm{uf}}}
\newcommand{\FUFCMA}{\mathbf{G}^{\mathrm{f}\mbox{-}\mathrm{uf}}}
\newcommand{\mFUFCMA}{\mathbf{G}^{\mathrm{f}\mbox{-}\mathrm{uf}}}
\newcommand{\chusr}[0]{\usr_*}
\newcommand{\chmsg}[0]{\msg_*}
\newcommand{\chsig}[0]{\sigma_*}

\newcommand{\gamePRG}{\mathbf{G}^{\mathrm{prg}}}
\newcommand{\gamePRF}{\mathbf{G}^{\mathrm{prf}}}

\newcommand{\YTable}[0]{\mathrm{YT}}
\newcommand{\FTable}[0]{\mathrm{FT}}

\newcommand{\FH}{\mathsf{F}}
\newcommand{\GH}{\mathsf{G}}
\newcommand{\fh}{\mathsf{f}}
\newcommand{\fF}[0]{\construct{FF}}
\newcommand{\HG}{\overline{\HH}}
\newcommand{\hg}{\overline{\hh}}
\newcommand{\HASH}{\mathsc{FO}}
\newcommand{\HASHSim}{\mathsc{FOSim}}
\newcommand{\FUNCO}{\mathsc{FN}}
\newcommand{\eHASH}{\mathsc{PubO}}
\newcommand{\iHASH}{\mathsc{PrivO}}
\newcommand{\pHASH}{\mathsc{PQO}}
\newcommand{\fHASH}{\mathsc{FH}}
\newcommand{\HASHSET}{\mathsf{FS}}

\newcommand{\numBases}[0]{n}
\newcommand{\numDLQs}[0]{m}

\newcommand{\fOut}{H}
\newcommand{\fIn}{h}

\newcommand{\keySet}[0]{{\cal K}}


\newcommand{\Img}{\mathsf{Img}}
\newcommand{\froSp}[0]{\overline{\roSp}}
\newcommand{\PubS}[0]{\mathsf{Ext}}
\newcommand{\PrivS}[0]{\mathsf{Int}}
\newcommand{\arity}[0]{\mathsf{arity}}
\newcommand{\numPorts}[0]{\mathsf{np}}

\newcommand{\GEscheme}[0]{\mathbf{GE1}}
\newcommand{\NewGEscheme}[0]{\mathbf{GE}}
\newcommand{\fGEscheme}[0]{\overline{\mathbf{GE}}}
\newcommand{\VF}[0]{\mathrm{VF}}

\newcommand{\Clamp}{\mathrm{CF}}
\newcommand{\pF}[0]{\mathsf{F}}
\newcommand{\pVF}[0]{\mathrm{pVF}}
\newcommand{\sVF}[0]{\mathrm{sVF}}
\newcommand{\bVF}[0]{\mathrm{bVF}}
\newcommand{\digestEDSA}{d}

\newcommand{\birep}[1]{\langle #1\rangle}

\newcommand{\GDesc}[0]{\mathsf{gd}}
\newcommand{\Gorder}{\mathsf{ord}}
\newcommand{\EncF}[0]{\mathsf{en}}
\newcommand{\EncL}[0]{\mathsf{el}}
\newcommand{\DecF}[0]{\mathsf{de}}
\newcommand{\cofactor}[0]{\mathsf{f}}
\newcommand{\Prime}[0]{\mathsf{p}}
\newcommand{\identity}[0]{\mathbb{1}}
\newcommand{\oneEDSA}{\identity}
\newcommand{\usr}{v}

%PRF/PRG macros
\newcommand{\muPRF}{\mathrm{prf}}
\newcommand{\muPRG}{\mathrm{prg}}
\newcommand{\GmuPRF}{\mathbf{G}^{\muPRF}}
\newcommand{\GmuPRG}{\mathbf{G}^{\muPRG}}
\newcommand{\PRFexec}{\mathrm{Ev}}
\newcommand{\PRGexec}{\mathrm{Ev}}
\newcommand{\PRFkeylen}{\mathrm{kl}}
\newcommand{\PRGkeylen}{\mathrm{kl}}
\newcommand{\PRFoutlen}{\mathrm{ol}}
\newcommand{\PRGoutlen}{\mathrm{ol}}
\newcommand{\PRFinput}{X}

% secret-indiff, protected RO, multi-target ow sec macros
\newcommand{\func}{\aFunc{f}}
\newcommand{\secindiff}{\mathrm{sec-indiff}}
\newcommand{\findiff}{\mathrm{f}\mbox{-}\mathrm{indiff}}
\newcommand{\pindiff}{\mathrm{p}\mbox{-}\mathrm{indiff}}
\newcommand{\wpindiff}{\mathrm{wp}\mbox{-}\mathrm{indiff}}
\newcommand{\mtow}{\mathrm{mt-ow}}
\newcommand{\Gpindiff}{\mathbf{G}^{\pindiff}}
\newcommand{\Gwpindiff}{\mathbf{G}^{\wpindiff}}
\newcommand{\Gsecindiff}{\mathbf{G}^{\secindiff}}
\newcommand{\Gcrindiff}{\mathbf{G}^{\mathrm{cr-indiff}}}
\newcommand{\Gmtow}{\mathbf{G}^{\secindiff}}

\newcommand{\SecO}{\mathsc{Sec}}
\newcommand{\PrivOExt}{\mathsc{PrivExt}}
\newcommand{\PrivOInt}{\mathsc{PrivInt}}
\newcommand{\accessID}{\mathrm{acc}}
\newcommand{\distrib}{\mathds{D}}
\newcommand{\simstate}{{ss}}
\newcommand{\graph}{\mathsl{G}}
\newcommand{\edges}{\text{edges}}

\newcommand{\ppath}{path}
\newcommand{\ppathO}{\text{FindPath}}
\newcommand{\nodes}{\text{nodes}}
\newcommand{\IV}{IV}

\renewcommand{\S}{S}
\newcommand{\Out}{\mathsf{Out}}
\newcommand{\Sample}{\mathsf{Sample}}

\newcommand{\Filter}[0]{\mathsf{Flt}}
\newcommand{\FilterID}[0]{\mathsf{ID}}
\newcommand{\FilterSG}[0]{\Sg}
\newcommand{\FilterEv}[0]{\mathsf{Ev}}

\newcommand{\muFltEDDSA}{\Filter_{k, \numUsers, \Out}}
\newcommand{\FltEDDSA}{\overline{\Filter}_{k,\Prime}}

\newcommand{\IntIndx}[0]{\PrivS}
\newcommand{\ExtIndx}[0]{\mathsf{pub}}

\newcommand{\EdDSA}[0]{\mathsf{EdDSA}}
\newcommand{\Edtwo}[0]{\mathsf{Ed25519}}
\newcommand{\Schnorr}[0]{\mathsf{Schnorr}}

\newcommand{\AMAC}[0]{\mathsf{AMAC}}
\newcommand{\pfMAC}[0]{\mathsf{pfMAC}}

\newcommand{\qsim}[0]{q_{\simulator}}
\newcommand{\OutF}[0]{\mathsf{Out}}

\newcommand{\DtDTransform}[0]{\mathbf{DtD}}
\newcommand{\JCTransform}[0]{\mathbf{JCl}}
\newcommand{\PRGF}[0]{\construct{sK}}
\newcommand{\PRFF}[0]{\construct{dR}}
\newcommand{\OHF}[0]{\construct{bH}}
\newcommand{\startSpace}[0]{\FuncSp{SS}}
\newcommand{\enSpace}[0]{\FuncSp{ES}}

\newcommand{\advAGen}[1]{\advA_{#1}}
\newcommand{\advADS}[0]{\advAGen{\DS}}
\newcommand{\advAPRG}[0]{\advAGen{\PRGF}}
\newcommand{\advAPRF}[0]{\advAGen{\PRFF}}

\newcommand{\fullorAppendix}[1]{\iffull Appendix~\ref{#1}\else our full version~\cite{EPRINT:fullversion}\fi}

\newcommand{\Kg}{\mathsf{Kg}}
\newcommand{\MakePK}[0]{\mathsf{PK}}
\newcommand{\MakeSK}[0]{\mathsf{SK}}
\newcommand{\SigCoins}[0]{\mathsf{SR}}


\DeclareMathVersion{normal4}